# -- general -------------------------------------------------------------------
set-option -g default-terminal "screen-256color"
set-window-option -g xterm-keys on

set-option -g history-limit 10000000

set-option -g escape-time 0                     # fastest command sequences
set-option -g repeat-time 200

set-option -s focus-events on

set-option -g prefix2 C-a
bind-key C-a send-prefix -2

set-option -q -g status-utf8 on
set-window-option -q -g utf8 on

bind-key r source-file ~/.tmux.conf \; display '~/.tmux.conf sourced'

# -- display -------------------------------------------------------------------
set-option -g base-index 1                  # start windows numbering at 1
set-window-option -g pane-base-index 1      # make pane numbering consistent with windows

set-window-option -g automatic-rename on    # rename window to reflect current program
set-option -g renumber-windows on           # renumber windows when a window is closed

set-option -g display-panes-time 800        # slightly longer pane indicators display time
set-option -g display-time 1000             # slightly longer status messages display time

set-option -g status-interval 10            # redraw status line every 10 seconds

bind-key -n C-l send-keys C-l \; run 'sleep 0.1' \; clear-history

set-option -g monitor-activity on
set-option -g visual-activity off

# -- navigation ----------------------------------------------------------------
bind-key C-c new-session

bind-key -r h select-pane -L                # move left
bind-key -r j select-pane -D                # move down
bind-key -r k select-pane -U                # move up
bind-key -r l select-pane -R                # move right

bind-key > swap-pane -D                     # swap current pane with the next one
bind-key < swap-pane -U                     # swap current pane with the previous one

bind-key -r H resize-pane -L 2
bind-key -r J resize-pane -D 2
bind-key -r K resize-pane -U 2
bind-key -r L resize-pane -R 2

unbind-key n
unbind-key p
bind-key -r C-h previous-window             # select previous window
bind-key -r C-l next-window                 # select next window
bind-key BSpace last-window                 # move to last active window

unbind-key |
unbind-key -
bind-key | split-window -h -c "#{pane_current_path}"
bind-key - split-window -v -c "#{pane_current_path}"

unbind-key c
bind-key c new-window -c "#{pane_current_path}"

# -- copy mode -----------------------------------------------------------------

# vim-like copy mode
# Escape to enter copy mode (instead of [)
# v to start selection (instead of Space)
# y to yank to clipboard (instead of Enter)
# " to show (and choose) buffers (instead of =)
# p to paste buffer (instead of ])
# Ctrl+v to paste from clipboard
unbind-key [
unbind-key -T copy-mode-vi Escape
unbind-key -T copy-mode-vi Enter
# unbind-key p # using .tmux.conf binding
unbind-key -T copy-mode-vi Space
unbind-key -T copy-mode-vi y
unbind-key -T copy-mode-vi C-c
unbind-key =
unbind-key ]
unbind-key C-v
unbind-key -n C-v

set-option -g mode-keys vi
set-option -g status-keys vi
set-window-option -g mode-keys vi

bind-key Escape copy-mode-vi
bind-key C-v run "tmux set-buffer \"$(xclip -o -selection clipboard)\"; tmux paste-buffer"
bind-key -T copy-mode-vi Escape send-keys -X cancel
bind-key -T copy-mode-vi Enter send-keys -X cancel
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi V send-keys -X rectangle-toggle
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind-key -T copy-mode-vi C-c send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

unbind-key C-s
bind-key C-s set-window-option synchronize-panes \; display "Synchronization Toggled."

bind-key b list-buffers  # list paste buffers
bind-key p paste-buffer  # paste from the top paste buffer
bind-key P choose-buffer # choose which buffer to paste from

# -- Other -----------------------------------------------------------------
unbind-key C-s
bind-key C-s set-window-option synchronize-panes \; display "Synchronization Toggled."

# -- Plugins -----------------------------------------------------------------
set-option -g @plugin 'tmux-plugins/tpm'
set-option -g @plugin 'tmux-plugins/tmux-sensible'

set-option -g status off

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.vim/tmux/plugins/tpm/tpm'
